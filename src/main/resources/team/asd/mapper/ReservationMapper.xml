<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
		"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="team.asd.mapper.ReservationMapper">
	<resultMap id="ResultMap" type="team.asd.entity.Reservation">
		<id column="id" property="id"/>
		<result column="organization_id" property="organizationId"/>
		<result column="agent_id" property="agentId"/>
		<result column="customer_id" property="customerId"/>
		<result column="product_id" property="productId"/>
		<result column="from_date" property="fromDate"/>
		<result column="to_date" property="toDate"/>
		<result column="state" property="state"/>
		<result column="price" property="price"/>
		<result column="quote" property="quote"/>
		<result column="currency" property="currency"/>
		<result column="guests" property="guests"/>
		<result column="notes" property="notes"/>
		<result column="version" property="version"/>
	</resultMap>
	<select id="readById" parameterType="int" resultMap="ResultMap" resultType="team.asd.entity.Reservation">
		SELECT id, organization_id, agent_id, customer_id, product_id, state, from_date, to_date, price, quote, currency, guests, notes, version
		FROM reservation
		WHERE id =#{id}
	</select>
	<insert id="create" parameterType="team.asd.entity.Reservation" useGeneratedKeys="true" keyProperty="id">
		INSERT INTO reservation (organization_id, agent_id, customer_id, product_id <if test="state != null">, state</if>, from_date, to_date, price, quote,
		currency <if test="guests != null">, guests</if>, notes)
		VALUES (#{organizationId},#{agentId},#{customerId},#{productId},<if test="state != null">#{state},</if>#{fromDate},#{toDate},#{price},#{quote},#{currency},<if
			test="guests != null">#{guests},</if>#{notes})
	</insert>
	<update id="update" parameterType="team.asd.entity.Reservation">
		UPDATE
		reservation
		<set>
			<if test="organizationId!=null">organization_id=#{organizationId},</if>
			<if test="agentId!=null">agent_id=#{agentId},</if>
			<if test="customerId!=null">customer_id=#{customerId},</if>
			<if test="productId!=null">product_id=#{productId},</if>
			<if test="state!=null">state=#{state},</if>
			<if test="fromDate!=null">from_date=#{fromDate},</if>
			<if test="toDate!=null">to_date=#{toDate},</if>
			<if test="price!=null">price=#{price},</if>
			<if test="quote!=null">quote=#{quote},</if>
			<if test="guests!=null">guests=#{guests},</if>
			<if test="currency!=null">currency=#{currency},</if>
			<if test="notes!=null">notes=#{notes}</if>
		</set>
		WHERE id=#{id}
	</update>
	<delete id="delete" parameterType="int">
		UPDATE
		reservation
		SET state='Cancelled'
		WHERE id =#{id}
	</delete>
</mapper>
